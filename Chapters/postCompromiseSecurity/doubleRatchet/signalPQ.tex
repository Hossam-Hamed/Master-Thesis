\section{Post-Quantum Security of Signal Protocol}
The majority of cryptographic primitives are based on mathematical concepts that can be computed theoretically. However on the practical side, these calculations, are computationally challenging. Current cryptographic primitives are robust enough that they cannot be broken by an adversary with typically limited processing capacity. Previously, Shor \cite{shor94} and Grover \cite{gro96} proposed quantum algorithms that, in theory, can infringe the cryptographic principles in a wide range of cryptography primitives.
\par
Shor's algorithm is a quantum computer algorithm for determining an integer's prime factors. The algorithm executes in polynomial time, implying that the integer factorization problem can be performed effectively on a quantum computer. As a result, it could be used to break public-key cryptography schemes like RSA, Finite Field Diffie-Hellman key exchange, and Elliptic Curve Diffie-Hellman key exchange.
\par
Grover's algorithm, commonly known as the quantum search algorithm, is an unstructured search strategy that enhances search performance in unsorted data. When compared to standard counterpart techniques, it results in a quadratic speedup. Grover's algorithm, in the context of cryptography, basically tackles the problem of function inversion. The approach might be used in a variety of symmetric-key cryptography brute-force attacks, including collision and pre-image attacks. For example, it could brute-force a 128-bit symmetric cryptographic key in roughly $ 2^{64} $ iterations, or a 256-bit key in roughly $ 2^{128} $ iterations.
\par
The performance of a quantum computer is substantially superior to that of a regular computer. The security of various cryptographic primitives is jeopardized by the emergence of quantum computers. Hence, if a quantum computer with enough qubits is utilized, most asymmetric cryptography methods and protocols will be broken. On the other hand, if sufficiently high key sizes are used, most symmetric encryption techniques are now deemed quantum-safe. The same may be stated for the majority of hash functions as most of them stay quantum secure \cite{ber09}, given that it is required to create hashes of double the size \cite{bra+98}.
\par
Some existing cryptography is quantum-safe, although the majority of post-quantum algorithms are still in development. The \gls{nist} began the first step of standardizing numerous post-quantum algorithms in 2017. This standardization procedure examines 69 post-quantum algorithms \cite{chen2016report}. A subset of 26 algorithms were picked from the original candidate algorithms to proceed to the second phase of the procedure, where another group of algorithms was chosen to advance to the third stage of standardization \cite{alagic2020status}. Because the standardization process is not yet complete, the algorithms may be vulnerable to unforeseen flaws. During the process, the vulnerabilities are detected and the algorithms are refined, resulting in fewer uncovered issues. Nevertheless, the adoption of post-quantum algorithms at the moment is accompanied by some hardships. For instance, the majority of post-quantum algorithms employ keys of a greater size than those currently in use. Increased key size may make storing private keys on constrained devices, such as \gls{iot}, more complex, as well as impose a message overhead when conveying keys. Furthermore, the greater part of post-quantum algorithms require more complex computations. This computational complexity leads to longer computation times and increased energy usage. 
\par
As discussed earlier, the Signal Protocol consists of two fundamental components: the initial X3DH key exchange and the Double Ratchet for message exchange and the key update. The cryptographic primitives used in the protocol are: key exchanges, \glspl{kdf}, signature schemes, and symmetric encryption. The protocol specification employs the specific cryptographic algorithms listed in table \ref{tab:signal-alg}.

\begin{table}[htbp]
	\centering
	\caption{Pre-Quantum Signal Protocol Algorithms}
	\label{tab:signal-alg}
	\arrayrulecolor{black}
	\begin{tabular}{!{\color{black}\vrule}l!{\color{black}\vrule}l!{\color{black}\vrule}} 
		\hline
		\rowcolor[rgb]{ .745, .804, .843}	Cryptographic Primitives      & Algorithm used      \\ 
		\hline
		\hline
		Key exchange            & \acrshort{ecdh}, with Curve25519  \\ 
		\hline
		\gls{kdf}              & HKDF, with SHA-512    \\ 
		\hline
		X3DH Signature Scheme        & XEdDSA, with Curve25519 \\ 
		\hline
		Double Ratchet Symmetric Encryption & AES-256 in CBC mode   \\
		\hline
	\end{tabular}
\end{table}
Some of the protocol's components utilize algorithms which are considered quantum secure, or can be with a slight modification.
First, the KDF component which is usually based on cryptographic hash functions. It is crucial to use quantum secure hash functions, which is not related to the factorization problem. The Double Ratchet specification recommends implementing HKDF on an HMAC with SHA-256 or SHA-512. A HKDF based upon a SHA-2 as its underlying hash function has a significant impact on Gorver's algorithm search cost \cite{bogomolec2019towards}. So far, such HKDF is considered post-quantum secure.
\par
Next, the AES symmetric encryption algorithm used for message encryption. A quantum computer, with its improved calculating capabilities, can degrade this algorithm. Although not to the level that Shor's algorithm undermines asymmetric systems. The algorithm's quantum cryptographic security can be boosted by increasing the key size.
\par
Furthermore, \gls{ecc} algorithms are based on discrete logarithm problems for elliptic curves which are solved within a reasonable amount of time using Shor’s algorithm. Therefore, \gls{ecdh} is directly threatened by quantum computers and its operations are not post-quantum secure within the Signal protocol. Thus, each key exchange algorithm based on \gls{ecdh} as well as the signature scheme based on Curve25519 or Curve448 \glspl{ec}, which were recommended by the protocol specification, must be substituted by alternative post-quantum algorithms. 
Currently, many of the post-quantum key exchange algorithms require interaction from communicating parties during the key exchange, i.e. synchronous algorithms. While such algorithms are not a suitable substitute for use in X3DH, they can be used in a workaround for the double ratchet algorithm. However, they are not applicable as a substitute for X3DH as a non-interactive key exchange algorithm is essential.
\par
Although no real-world post-quantum secure variant is yet realized, Duits \cite{duits2019post} was the first to introduce a \gls{kem} based variant of Signal. She has proposed approaches to create hybrid post-quantum and complete post-quantum variants of the Signal protocol. A hybrid scheme is one that combines post-quantum algorithms and non post-quantum algorithms. She defines the current period where classical computers are dominant, while quantum computers are scarce and still under development as the transitional period. For the transitional period, she believes that a hybrid protocol would be useful and sufficient against a passive quantum attack. The hypothesis being, if the post-quantum scheme is broken, the security of the non post-quantum schemes could be relied upon. The work presents four partially hybrid variants of the protocol, meaning that at least one \gls{ecdh} key exchange is substituted. All the presented variants are not a perfect solution for a quantum secure Signal protocol as each lacks a security property in contrast to the pre-quantum variant.
The partial hybrid variants could be used as building blocks and combined to create further variants. For the transition period, it is argued that the most straightforward method would be to include at least one post-quantum initial key exchange, next to the \gls{ecdh} X3DH protocol. Namely, an extra post quantum \gls{otp} or \gls{ik} key exchange. However, neither variant offer future secrecy in the post-quantum world, as well as other security properties. For a complete quantum secure Signal protocol, her analysis concluded that the following algorithms are the most optimal substitutes among the algorithms in the experiment: the \gls{sidh} algorithm, specifically the SIDH503 version, for \gls{x3dh}; and a lattice-based \gls{kem}, specifically Kyber-512, for the double ratchet algorithm. The SIDH503 algorithm is considered a perfect substitute for \gls{ecdh}, while kyper512 imposes less delay per message by $ 0.03 $ seconds. Although, Kyber-512 requires a small change to integrate it into Signal Protocol unlike SIDH503 that can be used out of the box.
\par
However, Brendel et al. \cite{brendel2020towards} discuss limitations of \gls{sidh}-based key exchanges and \gls{kem}-based algorithms. Their claim was that key exchanges based on \gls{sidh} are not an adequate replacement for \gls{x3dh} as they are not secure due to their vulnerability to attacks against the protocol's key reuse. Although other \gls{sidh} proposals are more secure \cite{azarderakhsh2017post,basso2020adaptive,boneh2020multiparty}, their usability may be constrained due to their high cost, lack of scalability, or being inconclusive. On the other side, even though some of the \gls{kem}-based algorithms in the \gls{nist} process rely on the Fujisaki-Okamoto transform which provides safe key reuse for one party, they are inadequate to achieve asynchrony for an \gls{ake} as the encapsulating party cannot contribute non-ephemeral input and has to fully disclose the secret key behind their encapsulation. The authors present the concept of a split \gls{kem} to transfer the intended key-reusability of a DH-based protocol to a KEM-based flow. Their work intends to employ split \gls{kem} to transform the \gls{x3dh} handshake into a quantum-secure \gls{kem} setting without additional message flows. However, due to the unsolved challenge of proving that known \glspl{kem} are secure under their notion of split \gls{kem} with key reuse on both sides of communicating parties. Their work concludes that further research is required to develop securely robust post-quantum solutions with the same level of versatility as Diffie–Hellman-based primitives.
\par 
Building upon the outcome of two previously mentioned works, Stadler et al. \cite{stadler2021hybrid} describe a hybrid solution for a quantum secure Signal protocol by combining the original protocol with a post-quantum variant.Their proposal employs signatures in its replacement for the \gls{x3dh} \gls{ecdh} operations to avoid the vulnerability of \gls{kem} algorithms against key reuse. However among other deviations from the original protocol, the most obvious impact was the loss of deniability. Nevertheless, their approach towards double ratchet was to alter the algorithm using a \gls{kem}. Their implementation of the approach did not change any of the symmetric cryptography algorithm used in the pre-quantum protocol. However, the \gls{ecdh} algorithm was substituted by Kyber-786 and the signature algorithm was substituted by Dilithium 1280x1024. 